<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:HardwareEvents"
                    xmlns:converters="clr-namespace:HardwareEvents.Converters"
                    xmlns:flex="clr-namespace:OpenOptions.dnaFusion.Flex.V1"
                    xmlns:s="clr-namespace:System;assembly=mscorlib">

    <Style TargetType="local:DoorModeIcon">
        <Setter Property="DoorMode" Value="Disable"/>
        <Setter Property="DefaultModeForeground" Value="Green"/>
        <Setter Property="OfflineModeForeground" Value="Red"/>
        <Setter Property="StandardForeground" Value="Blue"/>
        <Setter Property="DefaultAndOfflineModeForeground">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="Green" Offset="0"/>
                    <GradientStop Color="Red" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="Foreground" Value="Blue"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:DoorModeIcon">
                    <ContentPresenter
                        Content="{TemplateBinding Content}"
                        ContentTemplate="{TemplateBinding ContentTemplate}"
                        Cursor="{TemplateBinding Cursor}"
                        Margin="{TemplateBinding Padding}"
                        HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="DisabledContentTemplate">
            <Setter.Value>
                <ControlTemplate TargetType="local:DoorModeIcon">
                    <Canvas Width="15.8694" Height="15.7398" Clip="F1 M 0,0L 15.8694,0L 15.8694,15.7398L 0,15.7398L 0,0" UseLayoutRounding="False">
                        <Path Width="15.8837" Height="15.7704" Canvas.Left="0" Canvas.Top="-0.0162603" Stretch="Fill" Fill="{TemplateBinding Foreground}" Data="F1 M 7.31428,0C 9.6653,-0.130082 11.6245,0.520325 13.1918,1.95122C 14.8898,3.46883 15.7823,5.24661 15.8694,7.28455C 16,9.7561 15.2381,11.8157 13.5837,13.4634C 12.1469,14.8943 10.4707,15.6531 8.5551,15.7398C 6.07347,15.8699 4.00544,15.1111 2.35102,13.4634C 0.783674,11.9024 0,10.0379 0,7.86992C 0,5.96206 0.609524,4.29268 1.82857,2.86179C 3.30884,1.08401 5.13741,0.130081 7.31428,0 Z M 9.27347,13.2683L 9.27347,2.27642L 7.5102,2.27642C 7.55374,3.14363 6.7483,3.57724 5.09388,3.57724L 5.09388,4.94309L 6.98775,4.94309L 6.98775,13.2683L 9.27347,13.2683 Z "/>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="UnlockedContentTemplate">
            <Setter.Value>
                <ControlTemplate TargetType="local:DoorModeIcon">
                    <Canvas Width="15.8694" Height="15.7398" Clip="F1 M 0,0L 15.8694,0L 15.8694,15.7398L 0,15.7398L 0,0" UseLayoutRounding="False">
                        <Path Width="15.8837" Height="15.7704" Canvas.Left="0" Canvas.Top="-0.0162603" Stretch="Fill" Fill="{TemplateBinding Foreground}" Data="F1 M 7.31428,0C 9.6653,-0.130082 11.6245,0.520325 13.1918,1.95122C 14.8898,3.46883 15.7823,5.24661 15.8694,7.28455C 16,9.7561 15.2381,11.8157 13.5837,13.4634C 12.1469,14.8943 10.4707,15.6531 8.5551,15.7398C 6.07347,15.8699 4.00544,15.1111 2.35102,13.4634C 0.783674,11.9024 0,10.0379 0,7.86992C 0,5.96206 0.609524,4.29268 1.82857,2.86179C 3.30884,1.08401 5.13741,0.130081 7.31428,0 Z M 10.5796,8.3252C 11.015,8.02168 11.385,7.60975 11.6898,7.08943C 11.9946,6.5691 12.1469,6.00542 12.1469,5.39837C 12.1469,4.4878 11.7769,3.729 11.0367,3.12195C 10.3401,2.60162 9.49116,2.31978 8.48979,2.27642C 7.14013,2.23306 6.0517,2.55826 5.22449,3.25203C 4.44082,3.90244 3.94014,4.74797 3.72245,5.78862L 6.46531,6.11382C 6.50884,5.59349 6.66122,5.13821 6.92245,4.74797C 7.22721,4.40108 7.59728,4.20596 8.03265,4.1626C 8.46803,4.20596 8.81633,4.3794 9.07755,4.68293C 9.29524,4.94309 9.40408,5.18157 9.40408,5.39837C 9.44762,6.17886 9.18639,6.76423 8.62041,7.15447C 6.83537,8.542 5.33333,9.99458 4.11428,11.5122L 4.11428,13.2683L 11.8204,13.2683L 11.8204,11.252L 6.98775,11.252C 7.20544,11.0352 7.77143,10.5583 8.68571,9.82114C 9.55646,9.12737 10.1878,8.62873 10.5796,8.3252 Z "/>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="LockedContentTemplate">
            <Setter.Value>
                <ControlTemplate TargetType="local:DoorModeIcon">
                    <Canvas Width="15.8694" Height="15.7398" Clip="F1 M 0,0L 15.8694,0L 15.8694,15.7398L 0,15.7398L 0,0" UseLayoutRounding="False">
                        <Path Width="15.8837" Height="15.7704" Canvas.Left="0" Canvas.Top="-0.0162603" Stretch="Fill" Fill="{TemplateBinding Foreground}" Data="F1 M 7.31428,0C 9.6653,-0.130082 11.6245,0.520325 13.1918,1.95122C 14.8898,3.46883 15.7823,5.24661 15.8694,7.28455C 16,9.7561 15.2381,11.8157 13.5837,13.4634C 12.1469,14.8943 10.4707,15.6531 8.5551,15.7398C 6.07347,15.8699 4.00544,15.1111 2.35102,13.4634C 0.783674,11.9024 0,10.0379 0,7.86992C 0,5.96206 0.609524,4.29268 1.82857,2.86179C 3.30884,1.08401 5.13741,0.130081 7.31428,0 Z M 7.64081,13.5285C 9.38231,13.6152 10.6231,13.2032 11.3633,12.2927C 11.8422,11.729 12.0816,11.0569 12.0816,10.2764C 12.1687,8.75881 11.4068,7.91328 9.79592,7.73984C 11.1891,7.30623 11.8857,6.43902 11.8857,5.13821C 11.8857,4.271 11.4721,3.55556 10.6449,2.99187C 9.9483,2.47154 9.09932,2.21138 8.09796,2.21138C 7.27075,2.21138 6.50884,2.42818 5.81224,2.86179C 4.89796,3.42547 4.26667,4.14092 3.91837,5.00813L 6.4,5.52845C 6.48707,5.18157 6.66122,4.85637 6.92245,4.55285C 7.14013,4.33604 7.4449,4.20596 7.83673,4.1626C 8.27211,4.11924 8.64218,4.24932 8.94694,4.55285C 9.12109,4.72629 9.22993,5.00813 9.27347,5.39837C 9.31701,6.04878 9.16463,6.43902 8.81633,6.5691C 8.51156,6.69919 7.81496,6.76423 6.72653,6.76423L 6.72653,8.52032C 7.8585,8.56368 8.62041,8.67208 9.01224,8.84553C 9.44762,9.10569 9.62177,9.58265 9.53469,10.2764C 9.49116,10.6667 9.36054,10.9919 9.14286,11.252C 8.83809,11.5989 8.42449,11.729 7.90204,11.6423C 7.03129,11.5989 6.46531,11.1436 6.20408,10.2764L 3.72245,10.6667C 4.33197,12.4878 5.63809,13.4417 7.64081,13.5285 Z "/>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="FacilityCodeOnlyContentTemplate">
            <Setter.Value>
                <ControlTemplate TargetType="local:DoorModeIcon">
                    <Canvas Width="15.8694" Height="15.7398" Clip="F1 M 0,0L 15.8694,0L 15.8694,15.7398L 0,15.7398L 0,0" UseLayoutRounding="False">
                        <Path Width="15.8837" Height="15.7704" Canvas.Left="0" Canvas.Top="-0.0162603" Stretch="Fill" Fill="{TemplateBinding Foreground}" Data="F1 M 7.31428,0C 9.6653,-0.130082 11.6245,0.520325 13.1918,1.95122C 14.8898,3.46883 15.7823,5.24661 15.8694,7.28455C 16,9.7561 15.2381,11.8157 13.5837,13.4634C 12.1469,14.8943 10.4707,15.6531 8.5551,15.7398C 6.07347,15.8699 4.00544,15.1111 2.35102,13.4634C 0.783674,11.9024 0,10.0379 0,7.86992C 0,5.96206 0.609524,4.29268 1.82857,2.86179C 3.30884,1.08401 5.13741,0.130081 7.31428,0 Z M 10.449,10.4065L 12.5388,10.4065L 12.5388,8.52032L 10.449,8.52032L 10.449,2.27642L 7.96735,2.27642L 3.33061,8.45528L 3.33061,10.4065L 8.22857,10.4065L 8.22857,13.2683L 10.449,13.2683L 10.449,10.4065 Z M 8.22857,5.07317L 8.22857,8.52032L 5.61633,8.52032L 8.22857,5.07317 Z "/>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="CardOnlyContentTemplate">
            <Setter.Value>
                <ControlTemplate TargetType="local:DoorModeIcon">
                    <Canvas Width="15.8694" Height="15.7398" Clip="F1 M 0,0L 15.8694,0L 15.8694,15.7398L 0,15.7398L 0,0" UseLayoutRounding="False">
                        <Path Width="15.8837" Height="15.7704" Canvas.Left="0" Canvas.Top="-0.0162603" Stretch="Fill" Fill="{TemplateBinding Foreground}" Data="F1 M 7.31428,0C 9.6653,-0.130082 11.6245,0.520325 13.1918,1.95122C 14.8898,3.46883 15.7823,5.24661 15.8694,7.28455C 16,9.7561 15.2381,11.8157 13.5837,13.4634C 12.1469,14.8943 10.4707,15.6531 8.5551,15.7398C 6.07347,15.8699 4.00544,15.1111 2.35102,13.4634C 0.783674,11.9024 0,10.0379 0,7.86992C 0,5.96206 0.609524,4.29268 1.82857,2.86179C 3.30884,1.08401 5.13741,0.130081 7.31428,0 Z M 7.4449,13.5285C 8.75102,13.6152 9.79592,13.355 10.5796,12.748C 11.4939,12.0542 11.9946,11.1436 12.0816,10.0163C 12.2122,8.542 11.8422,7.41463 10.9714,6.63415C 10.2748,6.0271 9.44762,5.74526 8.48979,5.78862C 7.74966,5.83198 7.11837,6.09214 6.59592,6.5691L 6.72653,4.55285L 11.0367,4.55285L 11.0367,2.53658L 4.44082,2.53658L 4.3102,8.19512L 6.33469,8.6504C 6.68299,8.04336 7.24898,7.71816 8.03265,7.6748C 8.94694,7.6748 9.42585,8.2168 9.46939,9.30081C 9.55646,10.2547 9.36054,10.9268 8.88163,11.3171C 8.57687,11.6206 8.22857,11.7507 7.83673,11.7073C 7.0966,11.7073 6.57415,11.2737 6.26939,10.4065L 3.78775,10.7967C 4.39728,12.5745 5.61633,13.4851 7.4449,13.5285 Z "/>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="PinOnlyContentTemplate">
            <Setter.Value>
                <ControlTemplate TargetType="local:DoorModeIcon">
                    <Canvas Width="15.8694" Height="15.7398" Clip="F1 M 0,0L 15.8694,0L 15.8694,15.7398L 0,15.7398L 0,0" UseLayoutRounding="False">
                        <Path Width="15.8837" Height="15.7704" Canvas.Left="0" Canvas.Top="-0.0162603" Stretch="Fill" Fill="{TemplateBinding Foreground}" Data="F1 M 7.31428,0C 9.6653,-0.130082 11.6245,0.520325 13.1918,1.95122C 14.8898,3.46883 15.7823,5.24661 15.8694,7.28455C 16,9.7561 15.2381,11.8157 13.5837,13.4634C 12.1469,14.8943 10.4707,15.6531 8.5551,15.7398C 6.07347,15.8699 4.00544,15.1111 2.35102,13.4634C 0.783674,11.9024 0,10.0379 0,7.86992C 0,5.96206 0.609524,4.29268 1.82857,2.86179C 3.30884,1.08401 5.13741,0.130081 7.31428,0 Z M 7.5102,13.4634C 8.99047,13.5935 10.1442,13.2683 10.9714,12.4878C 11.7116,11.8374 12.0816,10.8835 12.0816,9.62601C 12.0816,8.45528 11.7986,7.54471 11.2327,6.89431C 10.5796,6.15718 9.77415,5.78862 8.81633,5.78862C 7.81496,5.83198 7.03129,6.15718 6.46531,6.76423C 6.50884,5.02981 7.07483,4.14092 8.16326,4.09756C 8.77279,4.14092 9.18639,4.40108 9.40408,4.87805L 11.6898,4.29268C 11.3415,3.64227 10.819,3.10027 10.1224,2.66667C 9.46939,2.31978 8.77279,2.14634 8.03265,2.14634C 6.77007,2.14634 5.72517,2.75339 4.89796,3.96748C 4.15782,5.09485 3.78775,6.50406 3.78775,8.19512C 3.78775,9.7561 4.17959,11.0352 4.96326,12.0325C 5.61633,12.8997 6.46531,13.3767 7.5102,13.4634 Z M 7.90204,7.80488C 8.38095,7.76152 8.75102,7.91328 9.01224,8.26016C 9.31701,8.65041 9.44762,9.19241 9.40408,9.88618C 9.36054,10.3631 9.22993,10.7534 9.01224,11.0569C 8.70748,11.4472 8.31565,11.6206 7.83673,11.5772C 7.48843,11.5339 7.18367,11.3604 6.92245,11.0569C 6.61769,10.71 6.46531,10.2981 6.46531,9.82114C 6.46531,9.30081 6.57415,8.86721 6.79184,8.52032C 7.05306,8.08672 7.42313,7.84824 7.90204,7.80488 Z "/>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="CardAndPinRequiredContentTemplate">
            <Setter.Value>
                <ControlTemplate TargetType="local:DoorModeIcon">
                    <Canvas Width="15.8694" Height="15.7398" Clip="F1 M 0,0L 15.8694,0L 15.8694,15.7398L 0,15.7398L 0,0" UseLayoutRounding="False">
                        <Path Width="15.8837" Height="15.7704" Canvas.Left="0" Canvas.Top="-0.0162603" Stretch="Fill" Fill="{TemplateBinding Foreground}" Data="F1 M 7.31428,0C 9.6653,-0.130082 11.6245,0.520325 13.1918,1.95122C 14.8898,3.46883 15.7823,5.24661 15.8694,7.28455C 16,9.7561 15.2381,11.8157 13.5837,13.4634C 12.1469,14.8943 10.4707,15.6531 8.5551,15.7398C 6.07347,15.8699 4.00544,15.1111 2.35102,13.4634C 0.783674,11.9024 0,10.0379 0,7.86992C 0,5.96206 0.609524,4.29268 1.82857,2.86179C 3.30884,1.08401 5.13741,0.130081 7.31428,0 Z M 7.83673,13.4634L 12.1469,3.8374L 12.1469,2.47154L 4.50612,2.47154L 4.50612,4.55285L 9.27347,4.55285L 5.09388,13.4634L 7.83673,13.4634 Z "/>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="CardOrPinRequiredContentTemplate">
            <Setter.Value>
                <ControlTemplate TargetType="local:DoorModeIcon">
                    <Canvas Width="15.8694" Height="15.7398" Clip="F1 M 0,0L 15.8694,0L 15.8694,15.7398L 0,15.7398L 0,0" UseLayoutRounding="False">
                        <Path Width="15.8837" Height="15.7704" Canvas.Left="0" Canvas.Top="-0.0162603" Stretch="Fill" Fill="{TemplateBinding Foreground}" Data="F1 M 7.31428,0C 9.6653,-0.130082 11.6245,0.520325 13.1918,1.95122C 14.8898,3.46883 15.7823,5.24661 15.8694,7.28455C 16,9.7561 15.2381,11.8157 13.5837,13.4634C 12.1469,14.8943 10.4707,15.6531 8.5551,15.7398C 6.07347,15.8699 4.00544,15.1111 2.35102,13.4634C 0.783674,11.9024 0,10.0379 0,7.86992C 0,5.96206 0.609524,4.29268 1.82857,2.86179C 3.30884,1.08401 5.13741,0.130081 7.31428,0 Z M 3.78775,10.3415C 3.78775,11.2087 4.13605,11.9241 4.83265,12.4878C 5.52925,13.0515 6.48707,13.355 7.70612,13.3984C 9.18639,13.4417 10.3184,13.1382 11.102,12.4878C 11.7551,12.0108 12.0816,11.3821 12.0816,10.6016C 12.1252,9.73442 11.951,9.08401 11.5592,8.6504C 11.1673,8.17344 10.5796,7.7832 9.79592,7.47967C 11.2327,7.08943 11.951,6.30894 11.951,5.13821C 11.951,4.31436 11.6245,3.66396 10.9714,3.18699C 10.1442,2.57994 9.14286,2.27642 7.96735,2.27642C 6.87891,2.27642 5.96462,2.5149 5.22449,2.99187C 4.44082,3.5122 4.02721,4.1626 3.98367,4.94309C 3.94014,6.2439 4.6585,7.08943 6.13877,7.47967C 5.44218,7.82656 4.89796,8.17344 4.50612,8.52032C 4.02721,9.04065 3.78775,9.6477 3.78775,10.3415 Z M 7.96735,4.09756C 8.27211,4.09756 8.5551,4.20596 8.81633,4.42276C 9.07755,4.68293 9.20816,5.05149 9.20816,5.52845C 9.16463,6.3523 8.75102,6.76423 7.96735,6.76423C 7.18367,6.76423 6.77007,6.3523 6.72653,5.52845C 6.72653,5.05149 6.85714,4.68293 7.11837,4.42276C 7.37959,4.20596 7.66258,4.09756 7.96735,4.09756 Z M 7.96735,8.52032C 8.44626,8.52032 8.81633,8.69377 9.07755,9.04065C 9.33877,9.34417 9.46939,9.69106 9.46939,10.0813C 9.51292,10.645 9.38231,11.0569 9.07755,11.3171C 8.77279,11.5772 8.40272,11.7073 7.96735,11.7073C 7.53197,11.7073 7.1619,11.5772 6.85714,11.3171C 6.55238,11.0135 6.42177,10.6016 6.46531,10.0813C 6.50884,9.69106 6.66122,9.32249 6.92245,8.97561C 7.18367,8.67208 7.53197,8.52032 7.96735,8.52032 Z "/>
                    </Canvas>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <converters:AtFaultConverter x:Key="AtFaultConverter" />
    <converters:InvertedBoolean x:Key="InvertedBoolean"/>

    <HierarchicalDataTemplate DataType="{x:Type local:DoorViewModel}" ItemsSource="{Binding Children}">
    	<StackPanel Orientation="Horizontal">
    		<Image x:Name="HardwareStateImage" Height="16" Source="../Assets/Disabled.png" Stretch="Fill" />
    		<Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/Door.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Margin="5,0,0,0" VerticalAlignment="Center">
                <Run Text="{Binding Door.Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding Door.Controller, Mode=OneWay}"/><Run Text=".D"/><Run Text="{Binding Door.DoorID, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Door.Description, Mode=OneWay}"/>
            </TextBlock>
            <StackPanel.ContextMenu>
                <ContextMenu>
                	<MenuItem Header="Mode" >
                        <MenuItem Header="Disabled" Command="{Binding Door.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.Disable}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="Disable" DefaultMode="{Binding Door.DefaultMode}" OfflineMode="{Binding Door.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Unlocked" Command="{Binding Door.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.Unlocked}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="Unlocked" DefaultMode="{Binding Door.DefaultMode}" OfflineMode="{Binding Door.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Locked" Command="{Binding Door.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.Locked}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="Locked" DefaultMode="{Binding Door.DefaultMode}" OfflineMode="{Binding Door.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Facility Code" Command="{Binding Door.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.FacilityCodeOnly}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="FacilityCodeOnly" DefaultMode="{Binding Door.DefaultMode}" OfflineMode="{Binding Door.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Card Only" Command="{Binding Door.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.CardOnly}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="CardOnly" DefaultMode="{Binding Door.DefaultMode}" OfflineMode="{Binding Door.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Pin Only" Command="{Binding Door.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.PinOnly}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="PinOnly" DefaultMode="{Binding Door.DefaultMode}" OfflineMode="{Binding Door.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Card and Pin" Command="{Binding Door.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.CardAndPinRequired}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="CardAndPinRequired" DefaultMode="{Binding Door.DefaultMode}" OfflineMode="{Binding Door.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Card or Pin" Command="{Binding Door.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.CardOrPinRequired}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="CardOrPinRequired" DefaultMode="{Binding Door.DefaultMode}" OfflineMode="{Binding Door.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem Header="Momentary Unlock" Command="{Binding Door.MomentaryUnlockCommand}"/>
                    <MenuItem Header="Alarm">
                        <MenuItem Header="Held Open" IsCheckable="True" Command="{Binding Door.DoorHeldMaskCommand}" IsChecked="{Binding Status.HeldMasked, Converter={StaticResource InvertedBoolean}}" ToolTipService.ToolTip="Held Open is armed if it is checked. Uncheck it to disarm."/>
                        <MenuItem Header="Forced Open" IsCheckable="True" Command="{Binding Door.DoorForcedMaskCommand}" IsChecked="{Binding Status.ForcedMasked, Converter={StaticResource InvertedBoolean}}" ToolTipService.ToolTip="Forced Open is armed if it is checked. Uncheck it to disarm."/>
                    </MenuItem>
                    <MenuItem Header="InfoReady">
                        <MenuItem Header="Trace History" Command="{Binding TraceHistoryByDoor}" />
                        <MenuItem Header="Who Does Not Have Access..." Command="{Binding WhoDoesNotHaveAccessToDoor}" />
                        <MenuItem Header="Who Has Access..." Command="{Binding WhoHasAccessToDoor}" />
                    </MenuItem>
                </ContextMenu>
            </StackPanel.ContextMenu>
        </StackPanel>
        <DataTemplate.Triggers>
        	<DataTrigger Binding="{Binding Status.Online}" Value="False">
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Undefined.png" />                	
        	</DataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="Disable"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Disabled.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Disabled" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="Unlocked"/>
                </MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Unlocked.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Unlocked" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="Locked"/>
                </MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Locked.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Locked" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="FacilityCodeOnly"/>
                </MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/FacilityCode.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Facility Code Only" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="CardOnly"/>
                </MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/CardOnly.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Card Only" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="PinOnly"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/PinOnly.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Pin Only" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="CardAndPinRequired"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Card_Pin.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Card and Pin Required" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="CardOrPinRequired"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Card_Or_Pin.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Card or Pin Required" />
        	</MultiDataTrigger>
        </DataTemplate.Triggers>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type local:ElevatorViewModel}" ItemsSource="{Binding Children}">
        <StackPanel Orientation="Horizontal">
            <Image x:Name="HardwareStateImage" Height="16" Source="../Assets/Disabled.png" Stretch="Fill" />
            <Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/Door.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Margin="5,0,0,0" VerticalAlignment="Center">
                <Run Text="{Binding Elevator.Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding Elevator.Controller, Mode=OneWay}"/><Run Text=".D"/><Run Text="{Binding Elevator.ElevatorID, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Elevator.Description, Mode=OneWay}"/>
            </TextBlock>
            <StackPanel.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Mode" >
                        <MenuItem Header="Disabled" Command="{Binding Elevator.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.Disable}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="Disable" DefaultMode="{Binding Elevator.DefaultMode}" OfflineMode="{Binding Elevator.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Unlocked" Command="{Binding Elevator.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.Unlocked}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="Unlocked" DefaultMode="{Binding Elevator.DefaultMode}" OfflineMode="{Binding Elevator.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Locked" Command="{Binding Elevator.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.Locked}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="Locked" DefaultMode="{Binding Elevator.DefaultMode}" OfflineMode="{Binding Elevator.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Facility Code" Command="{Binding Elevator.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.FacilityCodeOnly}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="FacilityCodeOnly" DefaultMode="{Binding Elevator.DefaultMode}" OfflineMode="{Binding Elevator.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Card Only" Command="{Binding Elevator.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.CardOnly}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="CardOnly" DefaultMode="{Binding Elevator.DefaultMode}" OfflineMode="{Binding Elevator.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Pin Only" Command="{Binding Elevator.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.PinOnly}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="PinOnly" DefaultMode="{Binding Elevator.DefaultMode}" OfflineMode="{Binding Elevator.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Card and Pin" Command="{Binding Elevator.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.CardAndPinRequired}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="CardAndPinRequired" DefaultMode="{Binding Elevator.DefaultMode}" OfflineMode="{Binding Elevator.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Card or Pin" Command="{Binding Elevator.ControlDoorModeCommand}" CommandParameter="{x:Static flex:DNADoorMode.CardOrPinRequired}">
                            <MenuItem.Icon>
                                <local:DoorModeIcon DoorMode="CardOrPinRequired" DefaultMode="{Binding Elevator.DefaultMode}" OfflineMode="{Binding Elevator.OfflineMode}"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem Header="Momentary Unlock Floor(s)">
                        <Grid Margin="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width=".5*"/>
                                <ColumnDefinition Width=".5*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="200"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Button Grid.Column="0" Grid.Row="0" Margin="3" Padding="3" Content="Select All" Command="{Binding SelectAllFloorsCommand}" />
                            <Button Grid.Column="1" Grid.Row="0" Margin="3" Padding="3" Content="Unselect All" Command="{Binding UnselectAllFloorsCommand}" />
                            <ListBox Grid.ColumnSpan="2" Grid.Column="0" Grid.Row="1" ItemsSource="{Binding Floors, Mode=OneWay}" Background="Transparent" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Auto">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}" Content="{Binding Item.Name, Mode=OneWay}"/>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            <Button Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Margin="12, 0, 12, 8" Content="Momentary Unlock" Command="{Binding UnlockFloorsCommand}"/>
                        </Grid>
                    </MenuItem>
                    <MenuItem Header="InfoReady">
                        <MenuItem Header="Trace History" Command="{Binding TraceHistoryByElevator}" />
                        <MenuItem Header="Who Does Not Have Access..." Command="{Binding WhoDoesNotHaveAccessToElevator}" />
                        <MenuItem Header="Who Has Access..." Command="{Binding WhoHasAccessToElevator}" />
                    </MenuItem>
                </ContextMenu>
            </StackPanel.ContextMenu>
        </StackPanel>
        <DataTemplate.Triggers>
            <DataTrigger Binding="{Binding Elevator.Status.Online}" Value="False">
                <Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Undefined.png" />
            </DataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Elevator.Status.Online}" Value="True"/>
                    <Condition Binding="{Binding Elevator.Status.DoorMode}" Value="Disable"/>
                </MultiDataTrigger.Conditions>
                <Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Disabled.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Disabled" />
            </MultiDataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Elevator.Status.Online}" Value="True"/>
                    <Condition Binding="{Binding Elevator.Status.DoorMode}" Value="Unlocked"/>
                </MultiDataTrigger.Conditions>
                <Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Unlocked.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Unlocked" />
            </MultiDataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Elevator.Status.Online}" Value="True"/>
                    <Condition Binding="{Binding Elevator.Status.DoorMode}" Value="Locked"/>
                </MultiDataTrigger.Conditions>
                <Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Locked.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Locked" />
            </MultiDataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Elevator.Status.Online}" Value="True"/>
                    <Condition Binding="{Binding Elevator.Status.DoorMode}" Value="FacilityCodeOnly"/>
                </MultiDataTrigger.Conditions>
                <Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/FacilityCode.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Facility Code Only" />
            </MultiDataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Elevator.Status.Online}" Value="True"/>
                    <Condition Binding="{Binding Elevator.Status.DoorMode}" Value="CardOnly"/>
                </MultiDataTrigger.Conditions>
                <Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/CardOnly.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Card Only" />
            </MultiDataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Elevator.Status.Online}" Value="True"/>
                    <Condition Binding="{Binding Elevator.Status.DoorMode}" Value="PinOnly"/>
                </MultiDataTrigger.Conditions>
                <Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/PinOnly.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Pin Only" />
            </MultiDataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Elevator.Status.Online}" Value="True"/>
                    <Condition Binding="{Binding Elevator.Status.DoorMode}" Value="CardAndPinRequired"/>
                </MultiDataTrigger.Conditions>
                <Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Card_Pin.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Card and Pin Required" />
            </MultiDataTrigger>
            <MultiDataTrigger>
                <MultiDataTrigger.Conditions>
                    <Condition Binding="{Binding Elevator.Status.Online}" Value="True"/>
                    <Condition Binding="{Binding Elevator.Status.DoorMode}" Value="CardOrPinRequired"/>
                </MultiDataTrigger.Conditions>
                <Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Card_Or_Pin.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Card or Pin Required" />
            </MultiDataTrigger>
        </DataTemplate.Triggers>
    </HierarchicalDataTemplate>

    <DataTemplate DataType="{x:Type flex:DNAInputPoint}">
    	<StackPanel Orientation="Horizontal">
    		<Image x:Name="HardwareStateImage" Height="16" Source="../Assets/Active.png" Stretch="Fill" />
    		<Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/MP.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Margin="5,0,0,0" VerticalAlignment="Center">
                <Run Text="{Binding Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding Controller, Mode=OneWay}"/><Run Text=".I"/><Run Text="{Binding PointNumber, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Description, Mode=OneWay}"/>
            </TextBlock>
            <StackPanel.ContextMenu>
            	<ContextMenu>
            		<MenuItem Header="Arm" Command="{Binding MaskPointCommand}">
            			<MenuItem.CommandParameter>
            				<s:Boolean>True</s:Boolean>
            			</MenuItem.CommandParameter>
            		</MenuItem>
                    <MenuItem Header="Disarm" Command="{Binding MaskPointCommand}">
            			<MenuItem.CommandParameter>
            				<s:Boolean>False</s:Boolean>
            			</MenuItem.CommandParameter>
            		</MenuItem>
            	</ContextMenu>
            </StackPanel.ContextMenu>
        </StackPanel>
        <DataTemplate.Triggers>
        	<DataTrigger Binding="{Binding Status.Online}" Value="False">
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Offline.png" />
                <Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="Gray" />
        	</DataTrigger>
            <MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.Fault}" Value="Inactive"/>
                    <Condition Binding="{Binding Status.Masked}" Value="False"/>
                    <Condition Binding="{Binding Status.Active}" Value="True"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Active.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Active" />
        	</MultiDataTrigger>
            <MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.Fault}" Value="Inactive"/>
                    <Condition Binding="{Binding Status.Masked}" Value="False"/>
                    <Condition Binding="{Binding Status.Active}" Value="False"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Normal.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Inactive" />
        	</MultiDataTrigger>
            <MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.Fault}" Value="Inactive"/>
                    <Condition Binding="{Binding Status.Masked}" Value="True"/>
                    <Condition Binding="{Binding Status.Active}" Value="True"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Active.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Masked: Active" />
        	</MultiDataTrigger>
            <MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.Fault}" Value="Inactive"/>
                    <Condition Binding="{Binding Status.Masked}" Value="True"/>
                    <Condition Binding="{Binding Status.Active}" Value="False"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Normal.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Masked: Inactive" />
        	</MultiDataTrigger>

            <MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
                    <Condition Binding="{Binding Status.Fault, Converter={StaticResource AtFaultConverter}}" Value="True"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Undefined.png" />
        	</MultiDataTrigger>
            
            <MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.Alarm}" Value="True"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="Red" />
        	</MultiDataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>
    
    <DataTemplate DataType="{x:Type flex:DNAOutputPoint}">
    	<StackPanel Orientation="Horizontal">
    		<Image x:Name="HardwareStateImage" Height="16" Source="../Assets/Active.png" Stretch="Fill" />
    		<Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/CP.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Margin="5,0,0,0" VerticalAlignment="Center">
                <Run Text="{Binding Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding Controller, Mode=OneWay}"/><Run Text=".O"/><Run Text="{Binding PointNumber, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Description, Mode=OneWay}"/>
            </TextBlock>
            <StackPanel.ContextMenu>
            	<ContextMenu>
            		<MenuItem Header="Activate" Command="{Binding ControlPointModeCommand}" CommandParameter="{x:Static flex:DNAControlPointMode.Activate}"/>
                    <MenuItem Header="Deactivate" Command="{Binding ControlPointModeCommand}" CommandParameter="{x:Static flex:DNAControlPointMode.Deactivate}"/>
                    <MenuItem Header="Momentary" Command="{Binding ControlPointModeCommand}" CommandParameter="{x:Static flex:DNAControlPointMode.Momentary}"/>                    	
            	</ContextMenu>
            </StackPanel.ContextMenu>
        </StackPanel>
        <DataTemplate.Triggers>
        	<DataTrigger Binding="{Binding Status.Online}" Value="False">
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Offline.png" />
                <Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="Gray" />
        	</DataTrigger>
            <MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.Active}" Value="True"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Active.png" />
                <Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="LimeGreen" />
        	</MultiDataTrigger>
            <MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.Active}" Value="False"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Normal.png" />
        	</MultiDataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>

    <DataTemplate DataType="{x:Type flex:DNATimeSchedule}">
    	<StackPanel Orientation="Horizontal">
    		<Image x:Name="HardwareStateImage" Height="16" Source="../Assets/Active.png" Stretch="Fill" />
    		<Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/TS.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Margin="5,0,0,0" VerticalAlignment="Center">
                <Run Text="{Binding Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding Controller, Mode=OneWay}"/><Run Text=".TS"/><Run Text="{Binding TimeSchedule, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Description, Mode=OneWay}"/>
            </TextBlock>
            <StackPanel.ContextMenu>
                <ContextMenu BorderThickness="0">
                  <MenuItem Header="Temporary Off" Command="{Binding TimeScheduleModeCommand}" CommandParameter="{x:Static flex:DNATimeScheduleControl.TemporaryClear}"/>
                  <MenuItem Header="Temporary On" Command="{Binding TimeScheduleModeCommand}" CommandParameter="{x:Static flex:DNATimeScheduleControl.TemporarySet}"/>
                  <Separator />
                  <MenuItem Header="Override Off" Command="{Binding TimeScheduleModeCommand}" CommandParameter="{x:Static flex:DNATimeScheduleControl.OverrideClear}"/>
                  <MenuItem Header="Override On" Command="{Binding TimeScheduleModeCommand}" CommandParameter="{x:Static flex:DNATimeScheduleControl.OverrideSet}"/>
                  <Separator />
                  <MenuItem Header="Resume Normal State" Command="{Binding TimeScheduleModeCommand}" CommandParameter="{x:Static flex:DNATimeScheduleControl.ReturnToNormal}"/>
                  <MenuItem Header="Refresh Status" Command="{Binding TimeScheduleModeCommand}" CommandParameter="{x:Static flex:DNATimeScheduleControl.Refresh}"/>
                </ContextMenu>
            </StackPanel.ContextMenu>
        </StackPanel>
        <DataTemplate.Triggers>
        	<DataTrigger Binding="{Binding Status.Online}" Value="False">
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Offline.png" />  
        		<Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="Gray" />
        	</DataTrigger>
        	<DataTrigger Binding="{Binding Status.Active}" Value="True">
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Normal.png" />
        		<Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="LimeGreen" />
        	</DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>

    <DataTemplate DataType="{x:Type flex:DNAMonitorPointGroup}">
    	<StackPanel Orientation="Horizontal">
    		<Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/MPG2.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" VerticalAlignment="Center">
                <Run Text="{Binding Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding Controller, Mode=OneWay}"/><Run Text=".MPG"/><Run Text="{Binding MPGID, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Description, Mode=OneWay}"/>
            </TextBlock>
        </StackPanel>
        <DataTemplate.Triggers>
        	<DataTrigger Binding="{Binding MacroID}" Value="0">
        		<Setter TargetName="HardwareObjectImage" Property="Image.Source" Value="../Assets/MPG.png" />
        	</DataTrigger>
        	<DataTrigger Binding="{Binding Status.Online}" Value="False">
        		<Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="Gray" />
        	</DataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>
    
    <DataTemplate DataType="{x:Type flex:DNAMacro}">
        <StackPanel Orientation="Horizontal">
            <Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/MacroCommand.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" VerticalAlignment="Center">
                <Run Text="{Binding Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding Controller, Mode=OneWay}"/><Run Text=".M"/><Run Text="{Binding MacroID, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Description, Mode=OneWay}"/>
            </TextBlock>
            <StackPanel.ContextMenu>
                <ContextMenu>
                    <MenuItem Header="Execute Type 1" Command="{Binding ExecuteMacroCommand}" CommandParameter="1"/>
                    <MenuItem Header="Execute Type 2" Command="{Binding ExecuteMacroCommand}" CommandParameter="2"/>
                    <MenuItem Header="Execute Type 3" Command="{Binding ExecuteMacroCommand}" CommandParameter="3"/>
                    <MenuItem Header="Execute Type 4" Command="{Binding ExecuteMacroCommand}" CommandParameter="4"/>
                </ContextMenu>
            </StackPanel.ContextMenu>
        </StackPanel>
    </DataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type local:DoorCollection}" ItemsSource="{Binding}">
    	<StackPanel x:Name="HardwareObjectImage" Orientation="Horizontal">
    		<Image Height="16" Source="../Assets/Door.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Text="Doors" Margin="5,0,0,0" VerticalAlignment="Center"/>
        </StackPanel>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type local:ElevatorCollection}" ItemsSource="{Binding}">
        <StackPanel x:Name="HardwareObjectImage" Orientation="Horizontal">
            <Image Height="16" Source="../Assets/Elevator.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Text="Elevators" Margin="5,0,0,0" VerticalAlignment="Center"/>
        </StackPanel>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type local:TimeScheduleCollection}" ItemsSource="{Binding}">
    	<StackPanel Orientation="Horizontal">
    		<Image Height="16" Source="../Assets/TS.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Text="Time Schedules" Margin="5,0,0,0" VerticalAlignment="Center"/>
        </StackPanel>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type local:MonitorPointGroupCollection}" ItemsSource="{Binding}">
    	<StackPanel Orientation="Horizontal">
    		<Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/MPG.png" Stretch="Fill" Width="16"/>
            <TextBlock Text="MPGs" Margin="5,0,0,0" VerticalAlignment="Center"/>
        </StackPanel>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type flex:DNASubController}" ItemsSource="{Binding Children}">
    	<StackPanel Orientation="Horizontal">
    		<Image x:Name="HardwareStateImage" Height="16" Source="../Assets/Offline.png" Stretch="Fill" />
    		<Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/RSC1.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Margin="5,0,0,0" VerticalAlignment="Center">
                <Run Text="{Binding Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding .Controller, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding SubController, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Description, Mode=OneWay}"/>
            </TextBlock>
        </StackPanel>
        <DataTemplate.Triggers>
        	<DataTrigger Binding="{Binding Status.Online}" Value="False">
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Offline.png" />
        		<Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="Gray" />
        	</DataTrigger>
            <DataTrigger Binding="{Binding Status.Online}" Value="True">
            	<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Normal.png" />
            </DataTrigger>
        </DataTemplate.Triggers>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate DataType="{x:Type local:ControllerViewModel}" ItemsSource="{Binding Children}">
    	<StackPanel Orientation="Horizontal">
    		<Image x:Name="HardwareStateImage" Height="16" Source="../Assets/Offline.png" Stretch="Fill" />
    		<Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/SSP.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Margin="5,0,0,0" VerticalAlignment="Center">
                <Run Text="{Binding Controller.Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding Controller.Controller, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Controller.Description, Mode=OneWay}"/>
            </TextBlock>
        </StackPanel>
        <DataTemplate.Triggers>
        	<DataTrigger Binding="{Binding Status.Online}" Value="False">
        		<Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="Gray" />
        	</DataTrigger>
            <DataTrigger Binding="{Binding Status.Online}" Value="True">
            	<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Normal.png" />
            </DataTrigger>
        </DataTemplate.Triggers>
    </HierarchicalDataTemplate >

    <HierarchicalDataTemplate DataType="{x:Type local:MacroCollection}" ItemsSource="{Binding}">
        <StackPanel x:Name="HardwareObjectImage" Orientation="Horizontal">
            <Image Height="16" Source="../Assets/Macro.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Text="Macros" Margin="5,0,0,0" VerticalAlignment="Center"/>
        </StackPanel>
    </HierarchicalDataTemplate>

    <DataTemplate DataType="{x:Type flex:DNAReader}">
    	<StackPanel Orientation="Horizontal">
    		<Image x:Name="HardwareStateImage" Height="16" Source="../Assets/Active.png" Stretch="Fill" />
    		<Image x:Name="HardwareObjectImage" Height="16" Source="../Assets/Reader.png" Stretch="Fill" Width="16"/>
            <TextBlock x:Name="HardwareTextBlock" Margin="5,0,0,0" VerticalAlignment="Center">
                <Run Text="{Binding Site, Mode=OneWay}"/><Run Text="."/><Run Text="{Binding Controller, Mode=OneWay}"/><Run Text=".R"/><Run Text="{Binding ReaderNumber, Mode=OneWay}"/><Run Text=":"/>
                <Run Text="{Binding Description, Mode=OneWay}"/>
            </TextBlock>
        </StackPanel>
        <DataTemplate.Triggers>
        	<DataTrigger Binding="{Binding Status.Online}" Value="False">
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Offline.png" />
        		<Setter TargetName="HardwareTextBlock" Property="TextBlock.Foreground" Value="Gray" />
        	</DataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="Disable"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Disabled.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Disabled" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="Unlocked"/>
                </MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Unlocked.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Unlocked" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="Locked"/>
                </MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Locked.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Locked" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="FacilityCodeOnly"/>
                </MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/FacilityCode.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Facility Code Only" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="CardOnly"/>
                </MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/CardOnly.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Card Only" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="PinOnly"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/PinOnly.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Pin Only" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="CardAndPinRequired"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Card_Pin.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Card and Pin Required" />
        	</MultiDataTrigger>
        	<MultiDataTrigger>
        		<MultiDataTrigger.Conditions>
        			<Condition Binding="{Binding Status.Online}" Value="True"/>
        			<Condition Binding="{Binding Status.DoorMode}" Value="CardOrPinRequired"/>
        		</MultiDataTrigger.Conditions>
        		<Setter TargetName="HardwareStateImage" Property="Image.Source" Value="../Assets/Card_Or_Pin.png" />
                <Setter TargetName="HardwareStateImage" Property="Image.ToolTip" Value="Card or Pin Required" />
        	</MultiDataTrigger>
        </DataTemplate.Triggers>
    </DataTemplate>
    
    <DataTemplate DataType="{x:Type local:DummyLoadingObject}">
    	<StackPanel Orientation="Horizontal">
            <Grid x:Name="ImageLoading" Margin="5,0" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Viewbox Height="24" Width="24" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <local:CircularProgressBar />
                </Viewbox>
            </Grid>
            <TextBlock Margin="5,0" Text="Please Wait..." VerticalAlignment="Center" />
        </StackPanel>
    </DataTemplate>

    <converters:EventDescription x:Key="EventDescription" />

    <DataTemplate DataType="{x:Type local:EventSelectionModel}">
        <StackPanel Orientation="Horizontal">
            <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}">
                <TextBlock>
                    <Run Text="["/><Run Text="{Binding EventIndex}"/><Run Text="]"/>
                    <Run Text="{Binding EventIndex, Mode=OneWay, Converter={StaticResource EventDescription}}"/>
                </TextBlock>
            </CheckBox>
        </StackPanel>
    </DataTemplate>
</ResourceDictionary>